(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9090],{24194:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manager/order/order-list/detail",function(){return c(46867)}])},46867:function(a,b,c){"use strict";c.r(b),c.d(b,{"default":function(){return F}});var d=c(28520),e=c.n(d),f=c(85893),g=c(1413),h=c(67294),i={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"},j=c(42135),k=function(a,b){return h.createElement(j.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:b,icon:i}))};k.displayName="CaretRightOutlined";var l=h.forwardRef(k),m=c(54907),n=c(86010),o=c(11163),p=c(87536),q=c(88767),r=c(25617),s=c(48880),t=c(61474),u=c(12023),v=c(93702),w=c(9861),x=c(15755);function y(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function z(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function A(a,b){if(null==a)return{};var c,d,e=B(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function B(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||(e[c]=a[c]);return e}var C="TabPanel",D=m.Z.Panel,E=function(){var a,b,c,d,g,i,j=(0,r.v9)(function(a){return a.userCurretnInfo}),k=(0,o.useRouter)().query,u=Number((0,o.useRouter)().query.id),v=function(a){if(Array.isArray(a))return a}(i=h.useState(0))||function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c}(i,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}(),B=v[0],E=v[1],F=(0,x.CG)(x.s_);null==F||F.connectionId;var G=(0,w.Nj)({userSaleEnabled:!0,userOrderEnabled:!0}),H=G.userSale,I=G.userOrder,J=(0,p.cI)({mode:"onBlur"}),K=(0,q.useQuery)(["order-list",u],function(){return s.CY.getByID(+(null==k?void 0:k.id))},{onSuccess:function(a){var b,c;(null==a?void 0:null===(b=a.Data)|| void 0===b?void 0:b.IsCheckNotiPrice)||(null==a?void 0:null===(c=a.Data)|| void 0===c?void 0:c.OrderType)!==3||t.Amu.warning("Đơn h\xe0ng chưa cập nhật b\xe1o gi\xe1 cho kh\xe1ch!"),J.reset(null==a?void 0:a.Data)},onError:t.Amu.error,retry:!1,enabled:!!+(null==k?void 0:k.id),keepPreviousData:!0,refetchOnWindowFocus:!0,staleTime:2000}),L=K.data,M=K.isError,N=K.isLoading,O=K.isFetching,P=K.refetch,Q=(0,q.useMutation)(s.CY.update,{onSuccess:function(){t.Amu.success("Cập nhật đơn h\xe0ng th\xe0nh c\xf4ng"),P()},onError:function(a){var b,c,d;t.Amu.error(null===(b=a)|| void 0===b?void 0:null===(c=b.response)|| void 0===c?void 0:null===(d=c.data)|| void 0===d?void 0:d.ResultMessage)}}),R=function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){y(f,d,e,g,h,"next",a)}function h(a){y(f,d,e,g,h,"throw",a)}g(void 0)})}}(e().mark(function a(b){var c,d,f,g;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!((null==b?void 0:b.AmountDeposit)>(null==b?void 0:b.TotalPriceVND))){a.next=3;break}return t.Amu.error("Số tiền phải cọc kh\xf4ng được lớn hơn tổng tiền đơn"),a.abrupt("return");case 3:return c=b.HistoryOrderChanges,d=b.PayOrderHistories,f=b.Complains,100===(g=A(b,["HistoryOrderChanges","PayOrderHistories","Complains"])).Status&&(g.IsCheckNotiPrice=!1),a.next=7,Q.mutateAsync(g);case 7:case"end":return a.stop()}},a)}));return M?(0,f.jsx)(t.HYy,{}):(0,f.jsx)(p.RV,function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){z(a,b,c[b])})}return a}({},J,{children:(0,f.jsxs)("div",{className:"grid grid-cols-10 gap-4",style:{opacity:O?"0.8":"1",pointerEvents:O?"none":"all"},children:[(0,f.jsx)("div",{className:"col-span-3 xl:col-span-2",children:(0,f.jsx)("div",{style:{position:"sticky",top:"10px"},children:(0,f.jsx)(t.dnl,{active:B,handleActive:function(a){return E(a)},handleUpdate:R,data:null==L?void 0:L.Data,loading:O,refetch:P,RoleID:null==j?void 0:j.UserGroupId})})}),(0,f.jsx)("div",{className:"col-span-7 xl:col-span-8",children:(0,f.jsxs)(m.Z,{expandIconPosition:"right",expandIcon:function(a){var b=a.isActive;return(0,f.jsx)(l,{rotate:b?90:0})},defaultActiveKey:["1","2","3","4","5","6","7"],children:[(0,f.jsx)(D,{header:"M\xe3 đơn h\xe0ng (".concat((null==L?void 0:null===(a=L.Data)|| void 0===a?void 0:null===(b=a.MainOrderCodes)|| void 0===b?void 0:b.length)||0,")"),children:(0,f.jsx)("div",{id:"order-code",className:(0,n.Z)(C,0===B&&""),children:(0,f.jsx)(t.Z6V,{data:null==L?void 0:L.Data,loading:O,refetch:P,RoleID:null==j?void 0:j.UserGroupId})})},"1"),(0,f.jsx)(D,{header:"M\xe3 vận đơn (".concat((null==L?void 0:null===(c=L.Data)|| void 0===c?void 0:c.SmallPackages.length)||0,")"),children:(0,f.jsx)("div",{id:"transfer-code-list",className:(0,n.Z)(C,"!py-0",1===B&&""),children:(0,f.jsx)(t.NRd,{data:null==L?void 0:L.Data,loading:O,handleUpdate:R,RoleID:null==j?void 0:j.UserGroupId})})},"2"),(0,f.jsx)(D,{header:"Danh s\xe1ch sản phẩm (".concat((null==L?void 0:null===(d=L.Data)|| void 0===d?void 0:null===(g=d.Orders)|| void 0===g?void 0:g.length)||0,")"),children:(0,f.jsx)("div",{id:"product-list",className:(0,n.Z)(C,2===B&&""),children:(0,f.jsx)(t.GDN,{data:null==L?void 0:L.Data,loading:O,refetch:P,RoleID:null==j?void 0:j.UserGroupId})})},"3"),(0,f.jsx)(D,{header:"Chi ph\xed đơn h\xe0ng",children:(0,f.jsxs)("div",{id:"surcharge-list",className:(0,n.Z)(C,3===B&&""),children:[(0,f.jsx)(t.jE_,{data:null==L?void 0:L.Data,loading:O,handleUpdate:R,RoleID:null==j?void 0:j.UserGroupId}),(0,f.jsx)(t.o2B,{loading:O,data:null==L?void 0:L.Data,RoleID:null==j?void 0:j.UserGroupId})]})},"4"),(0,f.jsx)(D,{header:"Nh\xe2n vi\xean xử l\xfd",children:(0,f.jsx)("div",{id:"handling-staff",className:(0,n.Z)(C,5===B&&""),children:(0,f.jsx)(t.a3,{data:null==L?void 0:L.Data,userSaleCatalogue:H,userOrderCatalogue:I,loading:O,RoleID:null==j?void 0:j.UserGroupId})})},"5"),(0,f.jsx)(D,{header:"Th\xf4ng tin đặt h\xe0ng",children:(0,f.jsx)("div",{id:"order-info",className:(0,n.Z)(C,6===B&&""),children:(0,f.jsx)(t._in,{data:null==L?void 0:L.Data,loading:N})})},"6"),(0,f.jsx)(D,{header:"Lịch sử",children:(0,f.jsx)("div",{id:"history",className:(0,n.Z)(C,7===B&&""),children:(0,f.jsx)(t.gJx,{data:null==L?void 0:L.Data,loading:O})})},"7")]})})]})}))};E.displayName=v.B.oder.detail,E.breadcrumb=u.m.order.orderList.detail,E.Layout=t.Ar2;var F=E}},function(a){a.O(0,[675,296,3662,7570,7281,9930,9774,2888,179],function(){return a(a.s=24194)}),_N_E=a.O()}])